# ğŸ“Š DIAGRAMA VISUAL - Nuevo Flujo con ValidaciÃ³n de Admin

## Flujo Completo ASCII

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         RECUPERACIÃ“N DE CONTRASEÃ‘A CON VALIDACIÃ“N DE ADMIN        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ USUARIO INICIA  â”‚
                        â”‚ RECUPERACIÃ“N    â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Ingresa Email          â”‚
                    â”‚  usuario@example.com    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Validaciones:              â”‚
                    â”‚ âœ“ Email no vacÃ­o          â”‚
                    â”‚ âœ“ Email vÃ¡lido (xxx@x.x)  â”‚
                    â”‚ âœ“ Email registrado        â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚              â”‚
                    SI âœ“â”‚              â”‚NO âœ—
                         â”‚              â”‚
                         â”‚              â–¼
                         â”‚         ERROR:
                         â”‚        "No vinculado"
                         â”‚              â”‚
                         â”‚              â”‚
                         â”‚         [REINTENTAR]
                         â”‚              â–²
                         â”‚              â”‚
                         â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚                        â”‚
                         â–¼                        â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
        â”‚ SISTEMA EJECUTA:                   â”‚   â”‚
        â”‚                                    â”‚   â”‚
        â”‚ 1. Genera OTP: 456789             â”‚   â”‚
        â”‚ 2. Genera CÃ³digo Recovery: 123456 â”‚   â”‚
        â”‚ 3. ExpiraciÃ³n: 15 minutos         â”‚   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                     â”‚                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚ ENVÃA DOS EMAILS:                  â”‚ â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜ â”‚
                     â”‚                     â”‚    â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  EMAIL 1: ADMIN    â”‚     â”‚  EMAIL 2: USUARIO  â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”‚ CÃ³digo: 456789     â”‚     â”‚ CÃ³digo: 123456    â”‚
         â”‚ Usuario: usuario@  â”‚     â”‚ VÃ­nculo: click    â”‚
         â”‚ Fecha: 15/12...    â”‚     â”‚ para recuperar    â”‚
         â”‚ AcciÃ³n: Comparte   â”‚     â”‚                   â”‚
         â”‚ con el usuario     â”‚     â”‚ VÃ¡lido: 15 min    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                      â”‚
                  â”‚                      â”‚
                  â–¼                      â–¼
        ADMIN RECIBE OTP      USUARIO RECIBE CÃ“DIGO
        (456789)               (123456)
        
        â”‚                      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ ADMIN COMPARTE OTP CON USER  â”‚
        â”‚ (Mediante comunicaciÃ³n)       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ USUARIO INGRESA OTP EN APP   â”‚
        â”‚ Campo: [456789]              â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Validaciones OTP:               â”‚
        â”‚ âœ“ CÃ³digo correcto              â”‚
        â”‚ âœ“ No expirado (< 15 min)      â”‚
        â”‚ âœ“ Intentos < 3                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                   â”‚              â”‚
              SI âœ“â”‚              â”‚NO âœ—
                   â”‚              â”‚
                   â–¼              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  ERROR:
        â”‚ âœ“ OTP VÃLIDO     â”‚  "InvÃ¡lido"
        â”‚ Limpia OTP       â”‚  o "Expirado"
        â”‚ del sistema      â”‚  o "Intentos"
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  
                   â”‚
                   â”‚    [REINTENTAR]â—„â”€â”€â”€â”
                   â”‚    O ESPERAR 15min  â”‚
                   â”‚         â”‚           â”‚
                   â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ âœ“ USUARIO VE MENSAJE:            â”‚
        â”‚ "CÃ³digo verificado.              â”‚
        â”‚  Ahora establece tu nueva        â”‚
        â”‚  contraseÃ±a"                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ USUARIO COMPLETA FORMULARIO:     â”‚
        â”‚                                  â”‚
        â”‚ Nueva contraseÃ±a: [.....]       â”‚
        â”‚ Confirmar:        [.....]       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Validaciones ContraseÃ±a:        â”‚
        â”‚ âœ“ Ambos campos rellenados      â”‚
        â”‚ âœ“ Longitud >= 6 caracteres    â”‚
        â”‚ âœ“ ContraseÃ±as coinciden       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                   â”‚              â”‚
              SI âœ“â”‚              â”‚NO âœ—
                   â”‚              â”‚
                   â–¼              â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  ERROR:
        â”‚ Actualiza en        â”‚  Mostrar
        â”‚ Supabase:           â”‚  error
        â”‚ password = XXXX     â”‚  especÃ­fico
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ âœ“ Ã‰XITO:                        â”‚
        â”‚ "Â¡ContraseÃ±a restablecida!     â”‚
        â”‚  Ahora puedes iniciar sesiÃ³n   â”‚
        â”‚  con tu nueva contraseÃ±a"      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Sistema redirige a:              â”‚
        â”‚ Modal de LOGIN                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ USUARIO HACE LOGIN:              â”‚
        â”‚ Email: usuario@example.com       â”‚
        â”‚ Pass: NUEVA_CONTRASEÃ‘A           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ âœ“ Ã‰XITO - ACCESO PERMITIDO       â”‚
        â”‚ Usuario dentro de la aplicaciÃ³n  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Flujo Condensado

```
Usuario
  â”‚
  â”œâ”€ Solicita recuperaciÃ³n
  â”‚
  â”œâ”€ âœ“ Email validado
  â”‚
  â”œâ”€ Sistema genera:
  â”‚  â”œâ”€ OTP (456789) â†’ Admin
  â”‚  â””â”€ CÃ³digo (123456) â†’ Usuario
  â”‚
  â”œâ”€ Admin comparte OTP con usuario
  â”‚
  â”œâ”€ Usuario ingresa OTP en plataforma
  â”‚
  â”œâ”€ âœ“ OTP verificado
  â”‚
  â”œâ”€ Usuario establece nueva contraseÃ±a
  â”‚
  â”œâ”€ âœ“ ContraseÃ±a actualizada
  â”‚
  â”œâ”€ Redirige a login
  â”‚
  â”œâ”€ Usuario hace login con nueva pass
  â”‚
  â””â”€ âœ“ ACCESO PERMITIDO
```

## Decisiones y Validaciones

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DECISIONES                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ Â¿Email vacÃ­o?                                                  â”‚
â”‚ â”œâ”€ SÃ  â†’ ERROR "Por favor ingresa correo"                     â”‚
â”‚ â””â”€ NO  â†’ Siguiente                                            â”‚
â”‚                                                                 â”‚
â”‚ Â¿Email vÃ¡lido?                                                 â”‚
â”‚ â”œâ”€ NO  â†’ ERROR "Email invÃ¡lido"                               â”‚
â”‚ â””â”€ SÃ  â†’ Siguiente                                            â”‚
â”‚                                                                 â”‚
â”‚ Â¿Email registrado?                                             â”‚
â”‚ â”œâ”€ NO  â†’ ERROR "No estÃ¡ vinculado"                            â”‚
â”‚ â””â”€ SÃ  â†’ Genera OTP + CÃ³digo                                 â”‚
â”‚                                                                 â”‚
â”‚ [EnvÃ­a dos emails]                                             â”‚
â”‚ â”œâ”€ OTP â†’ Admin                                                â”‚
â”‚ â””â”€ CÃ³digo â†’ Usuario                                           â”‚
â”‚                                                                 â”‚
â”‚ Usuario ingresa OTP                                            â”‚
â”‚                                                                 â”‚
â”‚ Â¿OTP vÃ¡lido?                                                  â”‚
â”‚ â”œâ”€ NO â†’ ERROR "InvÃ¡lido, expirado o demasiados intentos"    â”‚
â”‚ â””â”€ SÃ â†’ Usuario puede cambiar contraseÃ±a                     â”‚
â”‚                                                                 â”‚
â”‚ Â¿ContraseÃ±a vÃ¡lida?                                           â”‚
â”‚ â”œâ”€ NO â†’ ERROR especÃ­fico                                      â”‚
â”‚ â””â”€ SÃ â†’ Actualiza en Supabase â†’ Ã‰XITO                        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Almacenamiento OTP

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  otpStorage = {                            â”‚
â”‚    'usuario@example.com': {               â”‚
â”‚      code: '456789',                      â”‚
â”‚      expiresAt: 1702648245000,            â”‚
â”‚      attempts: 0                          â”‚
â”‚    }                                       â”‚
â”‚  }                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”œâ”€ code: El cÃ³digo OTP de 6 dÃ­gitos
â”œâ”€ expiresAt: Timestamp cuando expira (15 minutos)
â””â”€ attempts: NÃºmero de intentos fallidos
             (mÃ¡ximo 3, luego error)
```

## Estados de la AplicaciÃ³n

```
Estado 1: Esperando email
â””â”€ Usuario escribe email

Estado 2: Email validado
â””â”€ OTP generado y enviado

Estado 3: Esperando OTP
â””â”€ Usuario ingresa cÃ³digo

Estado 4: OTP verificado
â””â”€ Usuario puede cambiar contraseÃ±a

Estado 5: Nueva contraseÃ±a ingresada
â””â”€ ValidaciÃ³n de contraseÃ±a

Estado 6: ContraseÃ±a actualizada
â””â”€ Redirige a login

Estado 7: Usuario hace login
â””â”€ Acceso permitido
```

## IntegraciÃ³n de Funciones

```
AuthModal.tsx
    â”‚
    â”œâ”€ handleRequestOtp()
    â”‚   â””â”€ requestPasswordResetWithAdminValidation()
    â”‚       â”œâ”€ isEmailRegistered()
    â”‚       â”œâ”€ generateOTP()
    â”‚       â”œâ”€ sendOTPToAdmin()
    â”‚       â””â”€ sendRecoveryLinkToUser()
    â”‚
    â”œâ”€ handleVerifyOtp()
    â”‚   â””â”€ verifyOTP()
    â”‚       â”œâ”€ Validar cÃ³digo
    â”‚       â”œâ”€ Validar expiraciÃ³n
    â”‚       â””â”€ Validar intentos
    â”‚
    â””â”€ handleResetPassword()
        â”œâ”€ Validar contraseÃ±a
        â”œâ”€ Validar confirmaciÃ³n
        â””â”€ updatePassword()
            â””â”€ supabase.auth.updateUser()
```

## Seguridad por Capas

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CAPA 1: ValidaciÃ³n de Email            â”‚
â”‚  â”œâ”€ No vacÃ­o                           â”‚
â”‚  â”œâ”€ Formato vÃ¡lido                     â”‚
â”‚  â””â”€ Registrado en BD                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CAPA 2: GeneraciÃ³n Segura              â”‚
â”‚  â”œâ”€ OTP aleatorio                      â”‚
â”‚  â”œâ”€ CÃ³digo Ãºnico                       â”‚
â”‚  â””â”€ ExpiraciÃ³n (15 min)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CAPA 3: ValidaciÃ³n del Admin           â”‚
â”‚  â”œâ”€ Admin recibe OTP                   â”‚
â”‚  â”œâ”€ Admin comparte con usuario         â”‚
â”‚  â””â”€ Usuario ingresa en plataforma      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CAPA 4: VerificaciÃ³n del CÃ³digo        â”‚
â”‚  â”œâ”€ ValidaciÃ³n de formato              â”‚
â”‚  â”œâ”€ ValidaciÃ³n de expiraciÃ³n           â”‚
â”‚  â””â”€ LÃ­mite de intentos (3)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CAPA 5: ActualizaciÃ³n Segura           â”‚
â”‚  â”œâ”€ ValidaciÃ³n de contraseÃ±a           â”‚
â”‚  â”œâ”€ ConfirmaciÃ³n coincide              â”‚
â”‚  â””â”€ ActualizaciÃ³n en Supabase          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Estos diagramas muestran el flujo completo del nuevo sistema de recuperaciÃ³n con validaciÃ³n de administrador.**
